/*
 * Nextflow configuration file
 */

// Global default params
params {
    // Input/Output
    reads = "data/*_R{1,2}.fastq.gz"
    outdir = "results"
    
    // Cutadapt primer filtering parameters
    primer = "^NNNNNNNNNNNNNNNNNCGC"  // 17 random bases (UMI) + CGC
    error_rate = 0.1
    min_length = 40
    quality_cutoff = 20
    
    // Resource defaults
    max_memory = '8.GB'
    max_cpus = 4
    max_time = '24.h'
}

// Process configuration
process {
    // Default resources for all processes
    cpus = 2
    memory = '4.GB'
    time = '2.h'
    
    // Process-specific resources
    withName: CUTADAPT {
        cpus = 4
        memory = '8.GB'
        time = '4.h'
    }
}

// Execution profiles
profiles {
    standard {
        process.executor = 'local'
    }
    
    docker {
        docker.enabled = true
        process {
            withName: CUTADAPT {
                container = 'quay.io/biocontainers/cutadapt:4.6--py39hf95cd2a_1'
            }
            withName: TRIM_AND_TRUNCATE {
                container = 'quay.io/biocontainers/cutadapt:4.6--py39hf95cd2a_1'
            }
        }
    }
    
    singularity {
        singularity.enabled = true
        singularity.autoMounts = true
        process {
            withName: CUTADAPT {
                container = 'https://depot.galaxyproject.org/singularity/cutadapt:4.6--py39hf95cd2a_1'
            }
            withName: TRIM_AND_TRUNCATE {
                container = 'https://depot.galaxyproject.org/singularity/cutadapt:4.6--py39hf95cd2a_1'
            }
        }
    }
    
    slurm {
        process.executor = 'slurm'
        process.queue = 'batch'
    }
}

// Report configuration
report {
    enabled = true
    file = "${params.outdir}/reports/execution_report.html"
}

timeline {
    enabled = true
    file = "${params.outdir}/reports/timeline.html"
}

trace {
    enabled = true
    file = "${params.outdir}/reports/trace.txt"
}

dag {
    enabled = true
    file = "${params.outdir}/reports/dag.html"
}

// Manifest
manifest {
    name = 'TTISS Pipeline'
    author = 'Your Name'
    description = 'Simple Cutadapt adapter trimming pipeline'
    mainScript = 'main.nf'
    nextflowVersion = '>=23.0.0'
    version = '1.0.0'
}
